<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<div id="chart_div"></div>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
  google.charts.load('upcoming', {packages: ['line']});
  google.charts.setOnLoadCallback(drawBasic);

  function drawBasic() {

    const data = google.visualization.arrayToDataTable([
      ['Data', 'Projetado', 'Aplicado', 'Total'],
      ['Jan/2017', 1400.00, 1885.00, 1885.00],
      ['Feb/2017', 2811.67, 2451.51, 2940.00],
      ['Mar/2017', 4235.10, 2969.21, 3484.55],
      ['Apr/2017', 5670.39, 3490.00, 4059.00],
      ['May/2017', 7117.64, 4015.09, 4608.00],
      ['Jun/2017', 8576.96, 5238.02, 5842.00],
      ['Jul/2017', 10048.43, 5866.67, 6500.00],
      ['Aug/2017', 11532.17, 8271.32, 9077.00],
      ['Sep/2017', 13028.27, 29261.78, 30150.00],
      ['Oct/2017', 14536.84, 29857.74, 31021.00],
      ['Nov/2017', 16057.98, 31257.74, 32703.00],
      ['Dec/2017', 17591.80, 35434.70, 36441.00],
      ['Jan/2018', 19188.39, 33952.70, 36621.00],
      ['Fev/2018', 20798.30, 33952.70, 36490],
    ])

    var options = {
      hAxis: {
        title: 'Tempo'
      },
      vAxis: {
        title: 'Montante'
      },
      width: 800,
      height: 600,
      colors: ['#b5bbc8', '#357ca5', '#008d4c']
    };

    var chart = new google.charts.Line(document.getElementById('chart_div'));

    chart.draw(data, options);

    // performance
    axios.get('/api/stats/performance-by-investment').then(({ data }) => {
      data.forEach(investment => {
        const idata = google.visualization.arrayToDataTable([
          ['Data', investment.name],
          ...(investment.BalanceUpdates.map(bal => [bal.date, bal.perf]))
        ]);

        const el = document.createElement('div');
        document.body.appendChild(el);
        const ichart = new google.charts.Line(el);
        ichart.draw(idata, { title: investment.name })
      });
    });
  }
</script>
</body>
</html>
